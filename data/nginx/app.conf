server {
    listen 80;
    server_name gabrielantonio.duckdns.org;

    root /public_html;
    index index.html index.php;

    location / {
        return 301 https://$host$request_uri;
    }    

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
}
server {
 
    listen 443 ssl;
    server_name services.sbis.cl;
    root /public_html;
    
    location / {
      index index.html index.php;
    }

    ssl_certificate /etc/letsencrypt/live/services.sbis.cl/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/services.sbis.cl/privkey.pem;
    
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    #ssl_buffer_size 10k;
    #ssl_protocols TLSv1.2 TLSv1.1 TLSv1;

    location /service-notification/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3900/;
        #proxy_pass http://192.168.30.15:3900/; 
        proxy_redirect off; 
    }

    location /service-compras/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3100/;
        #proxy_pass http://192.168.30.1:3100/; 
        proxy_redirect off; 
    }

    location /service-ventas/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3200/;
        #proxy_pass http://192.168.30.3:3200/; 
        proxy_redirect off; 
    }

    location /service-cliente/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3300/;
        #proxy_pass http://192.168.30.3:3300/; 
        proxy_redirect off; 
    }

    location /service-inventario/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3400/;
        #proxy_pass http://192.168.30.4:3400/; 
        proxy_redirect off; 
    }

    location /service-tesoreria/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3500/;
        #proxy_pass http://192.168.30.5:3500/; 
        proxy_redirect off; 
    }

    location /service-personal/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3600/;
        #proxy_pass http://192.168.30.6:3600/; 
        proxy_redirect off; 
    }

    location /service-remuneracion/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3700/;
        #proxy_pass http://192.168.30.7:3700/; 
        proxy_redirect off; 
    }

    location /service-ecommerce/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:3800/;
        #proxy_pass http://192.168.30.8:3800/; 
        proxy_redirect off; 
    }

    location /log/ {
        proxy_set_header Host $http_host; # required for docker client's sake
        proxy_set_header X-Real-IP $remote_addr; # pass on real client's IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://services.sbis.cl:4000/;
        #proxy_pass http://192.168.30.10:4000/; 
        proxy_redirect off; 
    }

    location /email/ { 
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host; 
        proxy_set_header X-NginX-Proxy true; 
        proxy_pass http://services.sbis.cl:5000/;
        #proxy_pass http://192.168.30.20:5000/; 
        proxy_redirect off; 
	   }
}